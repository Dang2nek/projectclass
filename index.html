<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Class Web Login</title>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
  import { getAuth, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";

  // üîπ C·∫•u h√¨nh Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyANHvtLT4TpJW9C6qhmNdiIGYcbe5th_Yw",
    authDomain: "classweb-11389.firebaseapp.com",
    projectId: "classweb-11389",
    storageBucket: "classweb-11389.firebasestorage.app",
    messagingSenderId: "91367336185",
    appId: "1:91367336185:web:30a78cfe10e459b0605a28",
    measurementId: "G-7123YZQKWV"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  // üîπ H√†m login
  async function login() {
    try {
      const result = await signInWithPopup(auth, provider);
      const user = result.user;

      // Prompt m√£ gi√°o vi√™n
      const code = prompt("Nh·∫≠p m√£ gi√°o vi√™n (n·∫øu c√≥):");

      if(code === "GV123"){  // V√≠ d·ª• m√£ gi√°o vi√™n
        await setDoc(doc(db, "teachers", user.uid), {
          name: user.displayName,
          email: user.email,
          role: "teacher",
          loginAt: new Date()
        });
        alert("Ch√†o gi√°o vi√™n!");
        window.location.href = "https://teachers-x4og.onrender.com/";
      } else {
        await setDoc(doc(db, "students", user.uid), {
          name: user.displayName,
          email: user.email,
          role: "student",
          loginAt: new Date()
        });
        alert("Ch√†o h·ªçc sinh!");
        window.location.href = "https://students-6fym.onrender.com/";
      }

    } catch(error) {
      console.error(error);
      alert("ƒêƒÉng nh·∫≠p th·∫•t b·∫°i!");
    }
  }
</script>

<style>
  body {
    font-family: Arial;
    background: #f0f2f5;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  button {
    padding: 12px 24px;
    font-size: 18px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: 0.3s;
  }
  button:hover { background-color: #45a049; }
  h1 { margin-bottom: 24px; }
</style>
</head>

<body>
  <h1>Class Web Login</h1>
  <button onclick="login()">ƒêƒÉng nh·∫≠p b·∫±ng Google</button>
</body>
</html>
